{"remainingRequest":"/Users/carol/Documents/ptcg_account_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/carol/Documents/ptcg_account_web/src/components/dialog/AddPurchaseItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/carol/Documents/ptcg_account_web/src/components/dialog/AddPurchaseItem.vue","mtime":1619056849675},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/cache-loader/dist/cjs.js","mtime":1617010042632},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/babel-loader/lib/index.js","mtime":1617010042638},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/cache-loader/dist/cjs.js","mtime":1617010042632},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/vue-loader/lib/index.js","mtime":1617010052190}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogWyJvcGVuRGlhbG9nIl0sCiAgZGF0YTogKCkgPT4gewogICAgcmV0dXJuIHsKICAgICAgZGF0ZTogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLnN1YnN0cigwLCAxMCksCiAgICAgIG1lbnU6IGZhbHNlLAogICAgICBuZXdQdXJjaGFzZUl0ZW1zOiB7CiAgICAgICAgcHVyY2hhc2U6IHsKICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgcHVyY2hhc2VyOiAiIiwKICAgICAgICAgIGRhdGU6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKS5zdWJzdHIoMCwgMTApLAogICAgICAgIH0sCiAgICAgICAgcHVyY2hhc2VSZWNvcmRzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHBva2Vtb25faWQ6ICIiLAogICAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgICAgY291bnQ6IDAsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgIH0sCiAgICAgIHB1cmNoYXNlckl0ZW1zOiBbIkNhcm9sIiwgIkNoYWQiXSwKICAgIH07CiAgfSwKICBjb21wdXRlZDogewogICAgLi4ubWFwR2V0dGVycyh7CiAgICAgIHBva2Vtb25zOiAicG9rZW1vbnMiLAogICAgfSksCiAgICB0b3RhbCgpIHsKICAgICAgbGV0IHJlc3VsdCA9IHsKICAgICAgICBwcmljZTogMCwKICAgICAgICBjb3VudDogMCwKICAgICAgfTsKICAgICAgZm9yIChjb25zdCBpdGVtIG9mIHRoaXMubmV3UHVyY2hhc2VJdGVtcy5wdXJjaGFzZVJlY29yZHMpIHsKICAgICAgICByZXN1bHQucHJpY2UgKz0gaXRlbS5wcmljZSAqIGl0ZW0uY291bnQ7CiAgICAgICAgcmVzdWx0LmNvdW50ICs9IHBhcnNlSW50KGl0ZW0uY291bnQpOwogICAgICB9CiAgICAgIHJldHVybiByZXN1bHQ7CiAgICB9LAogIH0sCiAgbWV0aG9kczogewogICAgY2xvc2VEaWFsb2dBY3Rpb24oKSB7CiAgICAgIHRoaXMuJGVtaXQoImNsb3NlRGlhbG9nIik7CiAgICAgIHRoaXMuY2xlYXJEYXRhKCk7CiAgICB9LAogICAgYWRkUHVyY2hhc2VJdGVtQWN0aW9uKCkgewogICAgICB0aGlzLm5ld1B1cmNoYXNlSXRlbXMucHVyY2hhc2VSZWNvcmRzLnB1c2goewogICAgICAgIHBva2Vtb25faWQ6ICIiLAogICAgICAgIHByaWNlOiAwLAogICAgICAgIGNvdW50OiAwLAogICAgICB9KTsKICAgIH0sCiAgICBhc3luYyBzdWJtaXRBY3Rpb24oKSB7CiAgICAgIGlmICghdGhpcy5uZXdQdXJjaGFzZUl0ZW1zLnB1cmNoYXNlLm5hbWUpIHJldHVybjsKICAgICAgaWYgKCF0aGlzLm5ld1B1cmNoYXNlSXRlbXMucHVyY2hhc2UucHVyY2hhc2VyKSByZXR1cm47CgogICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5uZXdQdXJjaGFzZUl0ZW1zLnB1cmNoYXNlUmVjb3JkcykgewogICAgICAgIGlmIChpdGVtLmNvdW50IDw9IDApIHJldHVybjsKICAgICAgICBpZiAoIWl0ZW0ucG9rZW1vbl9pZCkgcmV0dXJuOwogICAgICB9CgogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgKICAgICAgICAiY3JlYXRlUHVyY2hhc2VSZWNvcmQiLAogICAgICAgIHRoaXMubmV3UHVyY2hhc2VJdGVtcwogICAgICApOwoKICAgICAgdGhpcy5jbG9zZURpYWxvZ0FjdGlvbigpOwogICAgfSwKICAgIGNsZWFyRGF0YSgpIHsKICAgICAgdGhpcy5uZXdQdXJjaGFzZUl0ZW1zLnB1cmNoYXNlUmVjb3JkcyA9IFsKICAgICAgICB7IHBva2Vtb25faWQ6ICIiLCBwcmljZTogMCwgY291bnQ6IDAgfSwKICAgICAgXTsKICAgIH0sCiAgICByZW1vdmVJdGVtKGluZGV4KSB7CiAgICAgIHRoaXMubmV3UHVyY2hhc2VJdGVtcy5wdXJjaGFzZVJlY29yZHMuc3BsaWNlKGluZGV4LCAxKTsKICAgIH0sCiAgfSwKICBhc3luYyBtb3VudGVkKCkgewogICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goInF1ZXJ5UG9rZW1vbnMiKTsKICB9LAp9Owo="},{"version":3,"sources":["AddPurchaseItem.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8KA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddPurchaseItem.vue","sourceRoot":"src/components/dialog","sourcesContent":["<template>\n  <v-dialog\n    v-model=\"openDialog\"\n    transition=\"dialog-bottom-transition\"\n    fullscreen\n  >\n    <v-card style=\"display: flex; flex-direction: column; height: 100%\">\n      <v-card-title class=\"headline grey lighten-2\">\n        購買商品登錄\n      </v-card-title>\n\n      <!-- <v-container> -->\n      <v-card-text\n        style=\"flex: 1;\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n          overflow: hidden;\n          padding-bottom: 0;\"\n      >\n        <div style=\"display: flex; align-items: center\" class=\"mb-2\">\n          <v-text-field\n            v-model=\"newPurchaseItems.purchase.name\"\n            dense\n            outlined\n            hide-details\n            label=\"品項命名\"\n            class=\"mr-4\"\n          ></v-text-field>\n          <v-select\n            v-model=\"newPurchaseItems.purchase.purchaser\"\n            hide-details\n            dense\n            outlined\n            label=\"購買人\"\n            class=\"mr-4\"\n            :items=\"purchaserItems\"\n          ></v-select>\n          <v-menu\n            ref=\"menu\"\n            v-model=\"menu\"\n            :close-on-content-click=\"false\"\n            :return-value.sync=\"newPurchaseItems.purchase.date\"\n            transition=\"scale-transition\"\n            offset-y\n            min-width=\"auto\"\n          >\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-text-field\n                v-model=\"newPurchaseItems.purchase.date\"\n                readonly\n                v-bind=\"attrs\"\n                v-on=\"on\"\n              ></v-text-field>\n            </template>\n            <v-date-picker\n              v-model=\"newPurchaseItems.purchase.date\"\n              no-title\n              scrollable\n            >\n              <v-spacer></v-spacer>\n              <v-btn text color=\"primary\" @click=\"menu = false\">\n                Cancel\n              </v-btn>\n              <v-btn\n                text\n                color=\"primary\"\n                @click=\"$refs.menu.save(newPurchaseItems.purchase.date)\"\n              >\n                OK\n              </v-btn>\n            </v-date-picker>\n          </v-menu>\n        </div>\n\n        <v-list\n          style=\"height: 100%;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden\"\n        >\n          <v-list-item style=\"flex: 0\">\n            <v-list-item-content>\n              <v-list-item-title>商品名稱</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-content>\n              <v-list-item-title>購買價格（單張）</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-content>\n              <v-list-item-title>數量</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-content>\n              <v-list-item-title>小計</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-action>\n              <v-btn icon @click=\"addPurchaseItemAction\">\n                <v-icon color=\"grey lighten-1\">mdi-plus</v-icon>\n              </v-btn>\n            </v-list-item-action>\n          </v-list-item>\n          <div style=\"overflow: auto; height: 100%\">\n            <v-list-item\n              v-for=\"(item, index) of newPurchaseItems.purchaseRecords\"\n              :key=\"index\"\n            >\n              <v-list-item-content class=\"pr-2\">\n                <v-autocomplete\n                  v-model=\"item.pokemon_id\"\n                  :items=\"pokemons\"\n                  hide-no-data\n                  hide-selected\n                  item-text=\"name\"\n                  item-value=\"id\"\n                ></v-autocomplete>\n              </v-list-item-content>\n              <v-list-item-content class=\"pr-2 pl-2\">\n                <v-text-field\n                  v-model=\"item.price\"\n                  prefix=\"$\"\n                  step=\"5\"\n                  min=\"0\"\n                  type=\"number\"\n                ></v-text-field>\n              </v-list-item-content>\n              <v-list-item-content class=\"pr-2 pl-2\">\n                <v-text-field\n                  v-model=\"item.count\"\n                  min=\"0\"\n                  type=\"number\"\n                ></v-text-field>\n              </v-list-item-content>\n              <v-list-item-content class=\"pr-2 pl-2\">\n                {{ item.price * item.count }}\n              </v-list-item-content>\n              <v-list-item-action>\n                <v-btn\n                  icon\n                  @click=\"removeItem(index)\"\n                  :disabled=\"newPurchaseItems.purchaseRecords.length < 2\"\n                >\n                  <v-icon color=\"grey lighten-1\">mdi-close</v-icon>\n                </v-btn>\n              </v-list-item-action>\n            </v-list-item>\n          </div>\n        </v-list>\n      </v-card-text>\n\n      <v-card-text style=\"display: flex\">\n        <span>總計</span>\n        <v-spacer></v-spacer>\n        <span>\n          <span class=\"mr-10\">{{ total.count }} 張</span>\n          <span>共 {{ total.price }}</span>\n        </span>\n      </v-card-text>\n      <v-divider></v-divider>\n      <v-card-actions>\n        <v-btn @click=\"clearData\">\n          重置\n        </v-btn>\n        <v-spacer></v-spacer>\n        <v-btn @click=\"closeDialogAction\">\n          取消\n        </v-btn>\n        <v-btn color=\"primary\" @click=\"submitAction\">\n          登錄\n        </v-btn>\n      </v-card-actions>\n      <!-- </v-container> -->\n    </v-card>\n  </v-dialog>\n</template>\n<script>\n  import { mapGetters } from \"vuex\";\n\n  export default {\n    props: [\"openDialog\"],\n    data: () => {\n      return {\n        date: new Date().toISOString().substr(0, 10),\n        menu: false,\n        newPurchaseItems: {\n          purchase: {\n            name: \"\",\n            purchaser: \"\",\n            date: new Date().toISOString().substr(0, 10),\n          },\n          purchaseRecords: [\n            {\n              pokemon_id: \"\",\n              price: 0,\n              count: 0,\n            },\n          ],\n        },\n        purchaserItems: [\"Carol\", \"Chad\"],\n      };\n    },\n    computed: {\n      ...mapGetters({\n        pokemons: \"pokemons\",\n      }),\n      total() {\n        let result = {\n          price: 0,\n          count: 0,\n        };\n        for (const item of this.newPurchaseItems.purchaseRecords) {\n          result.price += item.price * item.count;\n          result.count += parseInt(item.count);\n        }\n        return result;\n      },\n    },\n    methods: {\n      closeDialogAction() {\n        this.$emit(\"closeDialog\");\n        this.clearData();\n      },\n      addPurchaseItemAction() {\n        this.newPurchaseItems.purchaseRecords.push({\n          pokemon_id: \"\",\n          price: 0,\n          count: 0,\n        });\n      },\n      async submitAction() {\n        if (!this.newPurchaseItems.purchase.name) return;\n        if (!this.newPurchaseItems.purchase.purchaser) return;\n\n        for (const item of this.newPurchaseItems.purchaseRecords) {\n          if (item.count <= 0) return;\n          if (!item.pokemon_id) return;\n        }\n\n        await this.$store.dispatch(\n          \"createPurchaseRecord\",\n          this.newPurchaseItems\n        );\n\n        this.closeDialogAction();\n      },\n      clearData() {\n        this.newPurchaseItems.purchaseRecords = [\n          { pokemon_id: \"\", price: 0, count: 0 },\n        ];\n      },\n      removeItem(index) {\n        this.newPurchaseItems.purchaseRecords.splice(index, 1);\n      },\n    },\n    async mounted() {\n      await this.$store.dispatch(\"queryPokemons\");\n    },\n  };\n</script>\n"]}]}
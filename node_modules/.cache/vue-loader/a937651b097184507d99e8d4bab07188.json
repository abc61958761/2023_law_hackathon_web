{"remainingRequest":"/Users/carol/Documents/ptcg_account_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/carol/Documents/ptcg_account_web/src/components/dialog/AddSoldItem.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/carol/Documents/ptcg_account_web/src/components/dialog/AddSoldItem.vue","mtime":1619055534867},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/babel-loader/lib/index.js","mtime":1617010042638},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/cache-loader/dist/cjs.js","mtime":1617010042632},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/vue-loader/lib/index.js","mtime":1617010052190}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKCmV4cG9ydCBkZWZhdWx0IHsKICBwcm9wczogWyJvcGVuRGlhbG9nIl0sCiAgZGF0YTogKCkgPT4gewogICAgcmV0dXJuIHsKICAgICAgbWVudTogZmFsc2UsCiAgICAgIG5ld1NvbGRJdGVtczogewogICAgICAgIHNvbGQ6IHsKICAgICAgICAgIG5hbWU6ICIiLAogICAgICAgICAgcGF5ZWU6ICIiLAogICAgICAgICAgc2FsZXNfY2hhbm5lbDogIiIsCiAgICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgICAgICB9LAogICAgICAgIHNvbGRSZWNvcmRzOiBbCiAgICAgICAgICB7CiAgICAgICAgICAgIHBva2Vtb25faWQ6ICIiLAogICAgICAgICAgICBwcmljZTogMCwKICAgICAgICAgICAgY291bnQ6IDAsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgIH0sCiAgICAgIHBheWVlSXRlbXM6IFsiQ2Fyb2wiLCAiQ2hhZCJdLAogICAgICBzYWxlc0NoYW5uZWxJdGVtczogWyLovYnkuqQiLCAi6J2m55quIl0sCiAgICB9OwogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoewogICAgICBwb2tlbW9uczogInBva2Vtb25zIiwKICAgIH0pLAogICAgdG90YWwoKSB7CiAgICAgIGxldCByZXN1bHQgPSB7CiAgICAgICAgcHJpY2U6IDAsCiAgICAgICAgY291bnQ6IDAsCiAgICAgIH07CiAgICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzLm5ld1NvbGRJdGVtcy5zb2xkUmVjb3JkcykgewogICAgICAgIHJlc3VsdC5wcmljZSArPSBpdGVtLnByaWNlICogaXRlbS5jb3VudDsKICAgICAgICByZXN1bHQuY291bnQgKz0gcGFyc2VJbnQoaXRlbS5jb3VudCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgfSwKICBtZXRob2RzOiB7CiAgICBjbG9zZURpYWxvZ0FjdGlvbigpIHsKICAgICAgdGhpcy4kZW1pdCgiY2xvc2VEaWFsb2ciKTsKICAgICAgdGhpcy5jbGVhckRhdGEoKTsKICAgIH0sCiAgICBhZGRTb2xkSXRlbUFjdGlvbigpIHsKICAgICAgdGhpcy5uZXdTb2xkSXRlbXMuc29sZFJlY29yZHMucHVzaCh7CiAgICAgICAgcG9rZW1vbl9pZDogIiIsCiAgICAgICAgcHJpY2U6IDAsCiAgICAgICAgY291bnQ6IDAsCiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHN1Ym1pdEFjdGlvbigpIHsKICAgICAgaWYgKCF0aGlzLm5ld1NvbGRJdGVtcy5zb2xkLm5hbWUpIHJldHVybjsKICAgICAgaWYgKCF0aGlzLm5ld1NvbGRJdGVtcy5zb2xkLnBheWVlKSByZXR1cm47CgogICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgdGhpcy5uZXdTb2xkSXRlbXMuc29sZFJlY29yZHMpIHsKICAgICAgICBpZiAoaXRlbS5jb3VudCA8PSAwKSByZXR1cm47CiAgICAgICAgaWYgKCFpdGVtLnBva2Vtb25faWQpIHJldHVybjsKICAgICAgfQoKICAgICAgYXdhaXQgdGhpcy4kc3RvcmUuZGlzcGF0Y2goImNyZWF0ZVNvbGRSZWNvcmQiLCB0aGlzLm5ld1NvbGRJdGVtcyk7CgogICAgICB0aGlzLmNsb3NlRGlhbG9nQWN0aW9uKCk7CiAgICB9LAogICAgY2xlYXJEYXRhKCkgewogICAgICB0aGlzLm5ld1NvbGRJdGVtcy5zb2xkID0gewogICAgICAgIG5hbWU6ICIiLAogICAgICAgIHBheWVlOiAiIiwKICAgICAgICBzYWxlc19jaGFubmVsOiAiIiwKICAgICAgICBkYXRlOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCkuc3Vic3RyKDAsIDEwKSwKICAgICAgfTsKICAgICAgdGhpcy5uZXdTb2xkSXRlbXMuc29sZFJlY29yZHMgPSBbCiAgICAgICAgeyBwb2tlbW9uX2lkOiAiIiwgcHJpY2U6IDAsIGNvdW50OiAwIH0sCiAgICAgIF07CiAgICB9LAogICAgcmVtb3ZlSXRlbShpbmRleCkgewogICAgICB0aGlzLm5ld1NvbGRJdGVtcy5zb2xkUmVjb3Jkcy5zcGxpY2UoaW5kZXgsIDEpOwogICAgfSwKICB9LAogIGFzeW5jIG1vdW50ZWQoKSB7CiAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgicXVlcnlQb2tlbW9ucyIpOwogIH0sCn07Cg=="},{"version":3,"sources":["AddSoldItem.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiLA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AddSoldItem.vue","sourceRoot":"src/components/dialog","sourcesContent":["<template>\n  <v-dialog\n    v-model=\"openDialog\"\n    transition=\"dialog-bottom-transition\"\n    fullscreen\n  >\n    <v-card style=\"display: flex; flex-direction: column; height: 100%\">\n      <v-card-title class=\"headline grey lighten-2\">\n        賣出商品登陸\n      </v-card-title>\n\n      <v-card-text\n        style=\"flex: 1;\n          display: flex;\n          flex-direction: column;\n          height: 100%;\n          overflow: hidden;\n          padding-bottom: 0;\"\n      >\n        <div style=\"display: flex; align-items: center\" class=\"mb-2\">\n          <v-text-field\n            v-model=\"newSoldItems.sold.name\"\n            dense\n            outlined\n            hide-details\n            label=\"品項命名\"\n            class=\"mr-4\"\n          ></v-text-field>\n          <v-select\n            v-model=\"newSoldItems.sold.sales_channel\"\n            hide-details\n            dense\n            outlined\n            label=\"賣出通路\"\n            class=\"mr-4\"\n            :items=\"salesChannelItems\"\n          ></v-select>\n          <v-select\n            v-model=\"newSoldItems.sold.payee\"\n            hide-details\n            dense\n            outlined\n            label=\"收款人\"\n            class=\"mr-4\"\n            :items=\"payeeItems\"\n          ></v-select>\n          <v-menu\n            ref=\"menu\"\n            v-model=\"menu\"\n            :close-on-content-click=\"false\"\n            :return-value.sync=\"newSoldItems.sold.date\"\n            transition=\"scale-transition\"\n            offset-y\n            min-width=\"auto\"\n          >\n            <template v-slot:activator=\"{ on, attrs }\">\n              <v-text-field\n                v-model=\"newSoldItems.sold.date\"\n                readonly\n                v-bind=\"attrs\"\n                v-on=\"on\"\n              ></v-text-field>\n            </template>\n            <v-date-picker v-model=\"newSoldItems.sold.date\" no-title scrollable>\n              <v-spacer></v-spacer>\n              <v-btn text color=\"primary\" @click=\"menu = false\">\n                Cancel\n              </v-btn>\n              <v-btn\n                text\n                color=\"primary\"\n                @click=\"$refs.menu.save(newSoldItems.sold.date)\"\n              >\n                OK\n              </v-btn>\n            </v-date-picker>\n          </v-menu>\n        </div>\n\n        <v-list\n          style=\"height: 100%;\n            display: flex;\n            flex-direction: column;\n            overflow: hidden\"\n        >\n          <v-list-item style=\"flex: 0\">\n            <v-list-item-content>\n              <v-list-item-title>商品名稱</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-content>\n              <v-list-item-title>購買價格（單張）</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-content>\n              <v-list-item-title>數量</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-content>\n              <v-list-item-title>小計</v-list-item-title>\n            </v-list-item-content>\n            <v-list-item-action>\n              <v-btn icon @click=\"addSoldItemAction\">\n                <v-icon color=\"grey lighten-1\">mdi-plus</v-icon>\n              </v-btn>\n            </v-list-item-action>\n          </v-list-item>\n          <div style=\"overflow: auto; height: 100%\">\n            <v-list-item\n              v-for=\"(item, index) of newSoldItems.soldRecords\"\n              :key=\"index\"\n            >\n              <v-list-item-content class=\"pr-2\">\n                <v-autocomplete\n                  v-model=\"item.pokemon_id\"\n                  :items=\"pokemons\"\n                  hide-no-data\n                  hide-selected\n                  item-text=\"name\"\n                  item-value=\"id\"\n                ></v-autocomplete>\n              </v-list-item-content>\n              <v-list-item-content class=\"pr-2 pl-2\">\n                <v-text-field\n                  v-model=\"item.price\"\n                  prefix=\"$\"\n                  step=\"5\"\n                  min=\"0\"\n                  type=\"number\"\n                ></v-text-field>\n              </v-list-item-content>\n              <v-list-item-content class=\"pr-2 pl-2\">\n                <v-text-field\n                  v-model=\"item.count\"\n                  min=\"0\"\n                  type=\"number\"\n                ></v-text-field>\n              </v-list-item-content>\n              <v-list-item-content class=\"pr-2 pl-2\">\n                {{ item.price * item.count }}\n              </v-list-item-content>\n              <v-list-item-action>\n                <v-btn\n                  icon\n                  :disabled=\"newSoldItems.soldRecords.length < 2\"\n                  @click=\"removeItem(index)\"\n                >\n                  <v-icon color=\"grey lighten-1\">mdi-close</v-icon>\n                </v-btn>\n              </v-list-item-action>\n            </v-list-item>\n          </div>\n        </v-list>\n      </v-card-text>\n\n      <v-card-text style=\"display: flex\">\n        <span>總計</span>\n        <v-spacer></v-spacer>\n        <span>\n          <span class=\"mr-10\">{{ total.count }} 張</span>\n          <span>共 {{ total.price }}</span>\n        </span>\n      </v-card-text>\n      <v-divider></v-divider>\n      <v-card-actions>\n        <v-btn @click=\"clearData\">\n          重置\n        </v-btn>\n        <v-spacer></v-spacer>\n        <v-btn @click=\"closeDialogAction\">\n          取消\n        </v-btn>\n        <v-btn color=\"primary\" @click=\"submitAction\">\n          登錄\n        </v-btn>\n      </v-card-actions>\n    </v-card>\n  </v-dialog>\n</template>\n<script>\n  import { mapGetters } from \"vuex\";\n\n  export default {\n    props: [\"openDialog\"],\n    data: () => {\n      return {\n        menu: false,\n        newSoldItems: {\n          sold: {\n            name: \"\",\n            payee: \"\",\n            sales_channel: \"\",\n            date: new Date().toISOString().substr(0, 10),\n          },\n          soldRecords: [\n            {\n              pokemon_id: \"\",\n              price: 0,\n              count: 0,\n            },\n          ],\n        },\n        payeeItems: [\"Carol\", \"Chad\"],\n        salesChannelItems: [\"轉交\", \"蝦皮\"],\n      };\n    },\n    computed: {\n      ...mapGetters({\n        pokemons: \"pokemons\",\n      }),\n      total() {\n        let result = {\n          price: 0,\n          count: 0,\n        };\n        for (const item of this.newSoldItems.soldRecords) {\n          result.price += item.price * item.count;\n          result.count += parseInt(item.count);\n        }\n        return result;\n      },\n    },\n    methods: {\n      closeDialogAction() {\n        this.$emit(\"closeDialog\");\n        this.clearData();\n      },\n      addSoldItemAction() {\n        this.newSoldItems.soldRecords.push({\n          pokemon_id: \"\",\n          price: 0,\n          count: 0,\n        });\n      },\n      async submitAction() {\n        if (!this.newSoldItems.sold.name) return;\n        if (!this.newSoldItems.sold.payee) return;\n\n        for (const item of this.newSoldItems.soldRecords) {\n          if (item.count <= 0) return;\n          if (!item.pokemon_id) return;\n        }\n\n        await this.$store.dispatch(\"createSoldRecord\", this.newSoldItems);\n\n        this.closeDialogAction();\n      },\n      clearData() {\n        this.newSoldItems.sold = {\n          name: \"\",\n          payee: \"\",\n          sales_channel: \"\",\n          date: new Date().toISOString().substr(0, 10),\n        };\n        this.newSoldItems.soldRecords = [\n          { pokemon_id: \"\", price: 0, count: 0 },\n        ];\n      },\n      removeItem(index) {\n        this.newSoldItems.soldRecords.splice(index, 1);\n      },\n    },\n    async mounted() {\n      await this.$store.dispatch(\"queryPokemons\");\n    },\n  };\n</script>\n"]}]}
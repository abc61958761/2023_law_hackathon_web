{"remainingRequest":"/Users/carol/Documents/ptcg_account_web/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/carol/Documents/ptcg_account_web/src/views/SettlementDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/carol/Documents/ptcg_account_web/src/views/SettlementDetail.vue","mtime":1620716350746},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/cache-loader/dist/cjs.js","mtime":1617010042632},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/babel-loader/lib/index.js","mtime":1617010042638},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/cache-loader/dist/cjs.js","mtime":1617010042632},{"path":"/Users/carol/Documents/ptcg_account_web/node_modules/vue-loader/lib/index.js","mtime":1617010052190}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IG1hcEdldHRlcnMgfSBmcm9tICJ2dWV4IjsKZXhwb3J0IGRlZmF1bHQgewogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB5ZWFyOiBudWxsLAogICAgICBtb250aDogbnVsbCwKICAgICAgc2hvd1Vuc3BsaXRQdXJjaGFzZTogZmFsc2UsCiAgICAgIHNob3dVbnNwbGl0U29sZDogZmFsc2UsCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgYXN5bmMgc3BsaXRQdXJjaGFzZShpZCkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic3BsaXRQdXJjaGFzZSIsIHsKICAgICAgICBpZCwKICAgICAgICB5ZWFyOiB0aGlzLnllYXIsCiAgICAgICAgbW9udGg6IHRoaXMubW9udGgsCiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHNwbGl0U29sZChpZCkgewogICAgICBhd2FpdCB0aGlzLiRzdG9yZS5kaXNwYXRjaCgic3BsaXRTb2xkIiwgewogICAgICAgIGlkLAogICAgICAgIHllYXI6IHRoaXMueWVhciwKICAgICAgICBtb250aDogdGhpcy5tb250aCwKICAgICAgfSk7CiAgICB9LAogICAgYXN5bmMgc3BsaXRQdXJjaGFzZXMoKSB7CiAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzcGxpdFB1cmNoYXNlcyIsIHsKICAgICAgICB5ZWFyOiB0aGlzLnllYXIsCiAgICAgICAgbW9udGg6IHRoaXMubW9udGgsCiAgICAgIH0pOwogICAgfSwKICAgIGFzeW5jIHNwbGl0U29sZHMoKSB7CiAgICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJzcGxpdFNvbGRzIiwgewogICAgICAgIHllYXI6IHRoaXMueWVhciwKICAgICAgICBtb250aDogdGhpcy5tb250aCwKICAgICAgfSk7CiAgICB9LAogIH0sCiAgY29tcHV0ZWQ6IHsKICAgIC4uLm1hcEdldHRlcnMoewogICAgICBzZXR0bGVtZW50RGV0YWlsOiAic2V0dGxlbWVudERldGFpbCIsCiAgICB9KSwKICAgIHRvdGFsU29sZCgpIHsKICAgICAgaWYgKCF0aGlzLnNldHRsZW1lbnREZXRhaWwuZGV0YWlsKSByZXR1cm4gMDsKICAgICAgcmV0dXJuICgKICAgICAgICB0aGlzLnNldHRsZW1lbnREZXRhaWwuZGV0YWlsLmNhcm9sX3NvbGRfcHJpY2UgKwogICAgICAgIHRoaXMuc2V0dGxlbWVudERldGFpbC5kZXRhaWwuY2hhZF9zb2xkX3ByaWNlCiAgICAgICk7CiAgICB9LAogICAgdG90YWxQdXJjaGFzZSgpIHsKICAgICAgaWYgKCF0aGlzLnNldHRsZW1lbnREZXRhaWwuZGV0YWlsKSByZXR1cm4gMDsKICAgICAgcmV0dXJuICgKICAgICAgICB0aGlzLnNldHRsZW1lbnREZXRhaWwuZGV0YWlsLmNoYWRfcHVyY2hhc2VfcHJpY2UgKwogICAgICAgIHRoaXMuc2V0dGxlbWVudERldGFpbC5kZXRhaWwuY2Fyb2xfcHVyY2hhc2VfcHJpY2UKICAgICAgKTsKICAgIH0sCiAgICB1blNwbGl0U29sZFRvdGFsKCkgewogICAgICBjb25zdCByZXN1bHQgPSB7CiAgICAgICAgY2Fyb2w6IDAsCiAgICAgICAgY2hhZDogMCwKICAgICAgfTsKICAgICAgZm9yIChjb25zdCBzb2xkIG9mIHRoaXMuc2V0dGxlbWVudERldGFpbC51bnNwbGl0U29sZHMpIHsKICAgICAgICBzd2l0Y2ggKHNvbGQucGF5ZWUpIHsKICAgICAgICAgIGNhc2UgIkNoYWQiOgogICAgICAgICAgICByZXN1bHQuY2hhZCArPSBzb2xkLnRvdGFsX3ByaWNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIkNhcm9sIjoKICAgICAgICAgICAgcmVzdWx0LmNhcm9sICs9IHNvbGQudG90YWxfcHJpY2U7CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CgogICAgICByZXR1cm4gcmVzdWx0OwogICAgfSwKICAgIHVuU3BsaXRQdXJjaGFzZVRvdGFsKCkgewogICAgICBjb25zdCByZXN1bHQgPSB7CiAgICAgICAgY2Fyb2w6IDAsCiAgICAgICAgY2hhZDogMCwKICAgICAgfTsKCiAgICAgIGZvciAoY29uc3QgcHVyY2hhc2Ugb2YgdGhpcy5zZXR0bGVtZW50RGV0YWlsLnVuc3BsaXRQdXJjaGFzZXMpIHsKICAgICAgICBzd2l0Y2ggKHB1cmNoYXNlLnB1cmNoYXNlcikgewogICAgICAgICAgY2FzZSAiQ2hhZCI6CiAgICAgICAgICAgIHJlc3VsdC5jaGFkICs9IHB1cmNoYXNlLnRvdGFsX3ByaWNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGNhc2UgIkNhcm9sIjoKICAgICAgICAgICAgcmVzdWx0LmNhcm9sICs9IHB1cmNoYXNlLnRvdGFsX3ByaWNlOwogICAgICAgICAgICBicmVhazsKICAgICAgICAgIGRlZmF1bHQ6CiAgICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQoKICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH0sCiAgfSwKICBhc3luYyBtb3VudGVkKCkgewogICAgdGhpcy55ZWFyID0gdGhpcy4kcm91dGUucXVlcnkueWVhcjsKICAgIHRoaXMubW9udGggPSB0aGlzLiRyb3V0ZS5xdWVyeS5tb250aDsKICAgIHRoaXMuc3RhdHVzID0gdGhpcy4kcm91dGUucXVlcnkuc3RhdHVzOwoKICAgIGF3YWl0IHRoaXMuJHN0b3JlLmRpc3BhdGNoKCJnZXRTZXR0bGVtZW50RGV0YWlsIiwgewogICAgICB5ZWFyOiB0aGlzLnllYXIsCiAgICAgIG1vbnRoOiB0aGlzLm1vbnRoLAogICAgICBzdGF0dXM6IHRoaXMuc3RhdHVzLAogICAgfSk7CiAgfSwKfTsK"},{"version":3,"sources":["SettlementDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4NA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA","file":"SettlementDetail.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div style=\"overflow: scroll; padding: 8px\">\n    <div>{{ year }} / {{ month }} 結算紀錄</div>\n\n    <div class=\"d-flex mt-4\">\n      <v-card class=\"d-flex flex-column mr-1\" height=\"200px\" style=\"flex:1\">\n        <v-card-title style=\"position: absolute;\">\n          本月營收\n        </v-card-title>\n        <v-card-text\n          class=\"d-flex flex-grow-1 justify-center align-center pt-4\"\n        >\n          <h1>${{ totalSold }}</h1>\n        </v-card-text>\n      </v-card>\n      <v-card class=\"d-flex ml-1 flex-column\" style=\"flex:1\">\n        <v-card-title style=\"position: absolute;\">\n          本月成本\n        </v-card-title>\n        <v-card-text\n          class=\"d-flex flex-grow-1 justify-center align-center pt-4\"\n        >\n          <h1>${{ totalPurchase }}</h1>\n        </v-card-text>\n      </v-card>\n      <v-card class=\"d-flex ml-1 flex-column\" style=\"flex:1\">\n        <v-card-title style=\"position: absolute;\">\n          本月總結\n        </v-card-title>\n        <v-card-text\n          class=\"d-flex flex-grow-1 justify-center align-center pt-4\"\n        >\n          <h1>$ {{ totalSold - totalPurchase }}</h1>\n        </v-card-text>\n      </v-card>\n    </div>\n\n    <div class=\"d-flex mt-4\" v-if=\"settlementDetail.detail\">\n      <v-card class=\"d-flex flex-column mr-1\" height=\"150px\" style=\"flex:1\">\n        <v-card-title>\n          Chad\n        </v-card-title>\n        <v-card-text class=\"d-flex flex-column flex-grow-1 justify-center\">\n          <div class=\"d-flex\">\n            本月付款\n            <h2 class=\"ml-3\">\n              $ {{ settlementDetail.detail.chad_purchase_price }}\n            </h2>\n          </div>\n          <div class=\"d-flex mt-2\">\n            本月付款\n            <h2 class=\"ml-3\">\n              $ {{ settlementDetail.detail.chad_sold_price }}\n            </h2>\n          </div>\n        </v-card-text>\n      </v-card>\n      <v-card class=\"d-flex ml-1 flex-column\" style=\"flex:1\">\n        <v-card-title>\n          Carol\n        </v-card-title>\n        <v-card-text class=\"d-flex flex-column flex-grow-1 justify-center \">\n          <div class=\"d-flex\">\n            本月付款\n            <h2 class=\"ml-3\">\n              $ {{ settlementDetail.detail.carol_purchase_price }}\n            </h2>\n          </div>\n          <div class=\"d-flex mt-2\">\n            本月收款\n            <h2 class=\"ml-3\">\n              $ {{ settlementDetail.detail.carol_sold_price }}\n            </h2>\n          </div>\n        </v-card-text>\n      </v-card>\n    </div>\n    <div class=\"d-flex mt-4\" v-if=\"settlementDetail.detail\">\n      <v-card class=\"d-flex flex-column mr-1\" style=\"flex: 1\">\n        <v-card-title class=\"d-flex\">\n          買入未拆帳\n          <v-spacer></v-spacer>\n          <v-btn\n            @click=\"splitPurchases()\"\n            :disabled=\"settlementDetail.unsplitPurchases.length === 0\"\n            >全部結算</v-btn\n          >\n        </v-card-title>\n        <v-card-text class=\"d-flex flex-column flex-grow-1 justify-center \">\n          <div class=\"d-flex\">\n            Carol\n            <h2 class=\"ml-3\">$ {{ unSplitPurchaseTotal.carol }}</h2>\n          </div>\n          <div class=\"d-flex mt-2\">\n            Chad\n            <h2 class=\"ml-3\">$ {{ unSplitPurchaseTotal.chad }}</h2>\n          </div>\n          <div class=\"d-flex\">\n            <v-spacer></v-spacer>\n            <v-btn\n              icon\n              @click=\"showUnsplitPurchase = !showUnsplitPurchase\"\n              :disabled=\"settlementDetail.unsplitPurchases.length === 0\"\n            >\n              <v-icon>{{\n                showUnsplitPurchase ? \"mdi-chevron-up\" : \"mdi-chevron-down\"\n              }}</v-icon>\n            </v-btn>\n          </div>\n        </v-card-text>\n        <v-expand-transition>\n          <div v-show=\"showUnsplitPurchase\">\n            <v-divider></v-divider>\n            <v-list>\n              <v-list-item\n                v-for=\"unsplitPurchase in settlementDetail.unsplitPurchases\"\n                :key=\"unsplitPurchase.id\"\n              >\n                <div class=\"mr-4\">\n                  <v-chip>{{ unsplitPurchase.purchaser }}</v-chip>\n                </div>\n\n                <v-list-item-content>\n                  {{ unsplitPurchase.name }}</v-list-item-content\n                >\n                <v-list-item-content>\n                  {{ new Date(unsplitPurchase.date).getFullYear() }} /\n                  {{ new Date(unsplitPurchase.date).getMonth() + 1 }} /\n                  {{\n                    new Date(unsplitPurchase.date).getDate()\n                  }}</v-list-item-content\n                >\n                <v-list-item-content>\n                  {{ unsplitPurchase.total_price }}</v-list-item-content\n                >\n\n                <v-list-item-action>\n                  <v-btn icon @click=\"splitPurchase(unsplitPurchase.id)\">\n                    <v-icon color=\"grey lighten-1\">mdi-check</v-icon>\n                  </v-btn>\n                </v-list-item-action>\n              </v-list-item>\n            </v-list>\n          </div>\n        </v-expand-transition>\n      </v-card>\n\n      <v-card class=\"d-flex ml-1 flex-column\" style=\"flex: 1\">\n        <v-card-title class=\"d-flex\">\n          賣出未拆帳\n          <v-spacer></v-spacer>\n          <v-btn\n            @click=\"splitSolds()\"\n            :disabled=\"settlementDetail.unsplitSolds.length === 0\"\n            >全部結算</v-btn\n          >\n        </v-card-title>\n        <v-card-text class=\"d-flex flex-column flex-grow-1 justify-center \">\n          <div class=\"d-flex\">\n            Carol\n            <h2 class=\"ml-3\">$ {{ unSplitSoldTotal.carol }}</h2>\n          </div>\n          <div class=\"d-flex mt-2\">\n            Chad\n            <h2 class=\"ml-3\">$ {{ unSplitSoldTotal.chad }}</h2>\n          </div>\n          <div class=\"d-flex\">\n            <v-spacer></v-spacer>\n\n            <v-btn\n              icon\n              @click=\"showUnsplitSold = !showUnsplitSold\"\n              :disabled=\"settlementDetail.unsplitSolds.length === 0\"\n            >\n              <v-icon>{{\n                showUnsplitSold ? \"mdi-chevron-up\" : \"mdi-chevron-down\"\n              }}</v-icon>\n            </v-btn>\n          </div>\n        </v-card-text>\n        <v-expand-transition>\n          <div v-show=\"showUnsplitSold\">\n            <v-divider></v-divider>\n            <v-list>\n              <v-list-item\n                v-for=\"unsplitSold in settlementDetail.unsplitSolds\"\n                :key=\"unsplitSold.id\"\n              >\n                <div class=\"mr-4\">\n                  <v-chip>{{ unsplitSold.payee }}</v-chip>\n                </div>\n\n                <v-list-item-content>\n                  {{ unsplitSold.name }}</v-list-item-content\n                >\n                <v-list-item-content>\n                  {{ new Date(unsplitSold.date).getFullYear() }} /\n                  {{ new Date(unsplitSold.date).getMonth() + 1 }} /\n                  {{\n                    new Date(unsplitSold.date).getDate()\n                  }}</v-list-item-content\n                >\n                <v-list-item-content>\n                  {{ unsplitSold.total_price }}</v-list-item-content\n                >\n\n                <v-list-item-action>\n                  <v-btn icon @click=\"splitSold(unsplitSold.id)\">\n                    <v-icon color=\"grey lighten-1\">mdi-check</v-icon>\n                  </v-btn>\n                </v-list-item-action>\n              </v-list-item>\n            </v-list>\n          </div>\n        </v-expand-transition>\n      </v-card>\n    </div>\n  </div>\n</template>\n<script>\n  import { mapGetters } from \"vuex\";\n  export default {\n    data() {\n      return {\n        year: null,\n        month: null,\n        showUnsplitPurchase: false,\n        showUnsplitSold: false,\n      };\n    },\n    methods: {\n      async splitPurchase(id) {\n        await this.$store.dispatch(\"splitPurchase\", {\n          id,\n          year: this.year,\n          month: this.month,\n        });\n      },\n      async splitSold(id) {\n        await this.$store.dispatch(\"splitSold\", {\n          id,\n          year: this.year,\n          month: this.month,\n        });\n      },\n      async splitPurchases() {\n        await this.$store.dispatch(\"splitPurchases\", {\n          year: this.year,\n          month: this.month,\n        });\n      },\n      async splitSolds() {\n        await this.$store.dispatch(\"splitSolds\", {\n          year: this.year,\n          month: this.month,\n        });\n      },\n    },\n    computed: {\n      ...mapGetters({\n        settlementDetail: \"settlementDetail\",\n      }),\n      totalSold() {\n        if (!this.settlementDetail.detail) return 0;\n        return (\n          this.settlementDetail.detail.carol_sold_price +\n          this.settlementDetail.detail.chad_sold_price\n        );\n      },\n      totalPurchase() {\n        if (!this.settlementDetail.detail) return 0;\n        return (\n          this.settlementDetail.detail.chad_purchase_price +\n          this.settlementDetail.detail.carol_purchase_price\n        );\n      },\n      unSplitSoldTotal() {\n        const result = {\n          carol: 0,\n          chad: 0,\n        };\n        for (const sold of this.settlementDetail.unsplitSolds) {\n          switch (sold.payee) {\n            case \"Chad\":\n              result.chad += sold.total_price;\n              break;\n            case \"Carol\":\n              result.carol += sold.total_price;\n              break;\n            default:\n              break;\n          }\n        }\n\n        return result;\n      },\n      unSplitPurchaseTotal() {\n        const result = {\n          carol: 0,\n          chad: 0,\n        };\n\n        for (const purchase of this.settlementDetail.unsplitPurchases) {\n          switch (purchase.purchaser) {\n            case \"Chad\":\n              result.chad += purchase.total_price;\n              break;\n            case \"Carol\":\n              result.carol += purchase.total_price;\n              break;\n            default:\n              break;\n          }\n        }\n\n        return result;\n      },\n    },\n    async mounted() {\n      this.year = this.$route.query.year;\n      this.month = this.$route.query.month;\n      this.status = this.$route.query.status;\n\n      await this.$store.dispatch(\"getSettlementDetail\", {\n        year: this.year,\n        month: this.month,\n        status: this.status,\n      });\n    },\n  };\n</script>\n"]}]}